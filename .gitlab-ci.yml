stages:
  - build

build:linux:
  stage: build
  before_script:
    - rm -rf build-debug
    - mkdir build-debug
    - cd build-debug
    - whoami
    - echo $PATH
  script:
    - cmake -DBUILD_SHARED_LIBS=ON ..
    - cmake --build .
  artifacts:
    paths:
      - build-debug/libmapgen.so*
    expire_in: 1 week
  tags:
    - linux
  allow_failure: false
build:windows:
  stage: build
  before_script:
    - if exist build-debug del build-debug
    - mkdir build-debug
    - cd build-debug
  script:
    - cmake -DBUILD_SHARED_LIBS=ON ..
    - cmake --build .
  artifacts:
    paths:
      - build-debug\Debug\mapgen.dll
      - build-debug\Debug\mapgen.pdb
      - build-debug\Debug\mapgen.ilk
    expire_in: 1 week
  tags:
    - windows
  allow_failure: false
